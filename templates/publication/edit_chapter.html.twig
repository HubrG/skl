{% extends 'base.html.twig' %}

{% block title %}Hello PublicationController!
{% endblock %}
{% block stylesheets %}
	<link href="//cdn.quilljs.com/1.3.6/quill.bubble.css" rel="stylesheet">
{% endblock %}
{% block javascripts %}{% endblock %}

{% block body %}
	<div class=" col-span-12">
		<h1 class=" -mt-10 mb-10 text-center ">
			<span class="text-xs">Édition du récit</span><br/>
			<span id="pubTitle" class="text-4xl">
				{{ infoPub.title|capitalize }}
			</span>
		</h1>
	</div>
	<aside class="col-span-10 col-start-2 inline-flex items-baseline justify-between -mt-5">

		<button onclick='window.location.href="{{path("app_publication_edit", {id:infoPub.id})}}"' class="button">Retour</button>
		<div class=" justify-end items-baseline flex">
			<div class="relative mr-2">
				<div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none mt-5">
					<i class="fa-solid fa-clock-rotate-left"></i>
				</div>
				<select name="status" class=" select" id="selectChapVersion">
					{% set myVal = 0 %}
					{% for items in infoChap.publicationChapterVersionings|sort((a, b) => b.created <=> a.created) %}
						{% set myVal = myVal + 1 %}
						<option value="{{ items.id }}">
							{% if myVal == 1 %}Version actuelle —
							{% else %}
								Version du
							{% endif %}
							{{ items.created|date('d/m/y - H:i:s', "Europe/Paris") }}
						</option>
					{% endfor %}
				</select>
			</div>
			<div class="relative  mr-2">
				<div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none mt-5">
					<i class="fa-solid fa-toggle-off"></i>
				</div>
				<select name="status" class="select">
					<option value="draft">Brouillon</option>
					<option value="published">Publié</option>
				</select>
			</div>
			<button type="button" class="button h-[54px]" id="saveChapter">Enregistrer</button>
		</div>
	</aside>
	<section class="col-span-10  col-start-2 h-screen -mt-3">
		<div id="editor" name="content" class="w-full border-2 border-slate-100 axiosChapter"></div>
		<script>
			var htmlToInsert = "{{ infoChap.content|raw }}"
var editor = document.getElementById('editor')
editor.innerHTML = htmlToInsert
		</script>
		<div class="mt-3">
			<p class="text-slate-500 text-sm">
				<i class="fa-solid fa-stopwatch-20 text-lg"></i>
				<span id="readTime">
					{{ infoChap.content|readInfo("ri_mn_ft") }}
					et
					{{ infoChap.content|readInfo("ri_sc_ft") }}
					de lecture

				</span>
				&nbsp;&nbsp;&nbsp;
				<i class="fa-solid fa-spell-check"></i>
				<span id="wordCount">
					{% set ri_wc = infoChap.content|readInfo("ri_wc") %}
					{{ ri_wc }}
					{% if ri_wc > 1 %}mots{% else %}mot
					{% endif %}
				</span>
				&nbsp;&nbsp;&nbsp;
				<i class="fa-solid fa-i-cursor"></i>
				<span id="signCount">
					{% set ri_cc = infoChap.content|readInfo("ri_cc") %}
					{{ ri_cc }}
					{% if ri_cc > 1 %}signes{% else %}signe
					{% endif %}
				</span>
				&nbsp;&nbsp;&nbsp;
				<i class="fa-solid fa-paragraph"></i>
				<span id="paragraphCount">
					{% set ri_pc = infoChap.content|readInfo("ri_pc") %}
					{{ ri_pc }}
					{% if ri_pc > 1 %}paragraphes{% else %}paragraphe
					{% endif %}
				</span>
			</p>
		</div>
	</section>
	<input type="hidden" value="{{ infoPub.id }}" id="hideIdPub"/>
	{% if infoChap.id is defined %}<input type="hidden" id="hideIdChap" value="{{ infoChap.id }}" id="hideId"/>
	{% endif %}
{% endblock %}
