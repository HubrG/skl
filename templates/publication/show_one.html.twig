{% extends 'base.html.twig' %}

{% block title %}
	{{ pubShow.title }}
	-
	{{ parent() }}
{% endblock %}

{% block body %}
	<style>
		#test
		{
			position: inherit;
			z-index: 1;
		}

		#test::before
		{
			content: "";
			position: absolute;
			display: inline;
			top: 0;
			left: 0;
			right: 0;
			width: 100%;
			height: 100%;
			opacity: .1;
			z-index: -99;
			background-image: url('{{ "https://picsum.photos/400/500" }}');
			background-position: center;
		}
	</style>
	<section class=" before:bg-cover before:blur-md  col-span-12 col-start-0 md:col-span-9 md:col-start-3 gap-10" id="test">
		<h1 class="text-center font-serif text-4xl bg-center text-slate-800" style="text-shadow: 0 0.5px 1px blanchedalmond;">{{ pubShow.title }}</h1>
		<h2 class="text-center -mt-8">
			<small>par</small>
			<span class="font-medium font-serif">
				<a class=" font-serif" href="{{ path("app_user", {username:pubShow.user.username}) }}">{{ pubShow.user.nickname }}</a>
			</span>
		</h2>
		<div class="flex justify-center">
			<img class=" rounded-full mt-6 object-cover w-40 h-40 justify-center  mb-5  pb-1 shaow-md lazy animate-pulse animate__animated bg-slate-300 grayscale-[50%]" loading="lazy" src="" data-src="{{ "https://picsum.photos/400/" ~ random(500, 520) }}" alt=""/>
		</div>
		<div class="flex gap-5 p-10 pt-0  items-center">
			<div class="flex-1 text-center flex flex-col justify-center items-center justify-items-center origin-center">
				<div class="md:flex">
					<p class="text-base font-serif text-justify italic text-slate-900 leading-6 -mt-2">
						{% if orderChap %}
							{% if pubShow.summary %}
								<i class="fa-solid fa-quote-left text-2xl"></i>&nbsp;
								{{ pubShow.summary }}... &nbsp;&nbsp;
								<div class="mt-5"></div>
							{% endif %}

						{% else %}
							<center>
								<i class="fa-solid fa-hourglass-half text-4xl font-thin text-slate-600"></i>
							</center>
							<br><span class="text-xl text-slate-500">Récit en cours de rédaction, aucune feuille pour le moment...</span>
						{% endif %}
					</p>
				</div>
				<a href="{{ path("app_chapter_show", {idChap:orderChap.id, slugPub:pubShow.slug, user:pubShow.user.username, slug:orderChap.slug}) }}" class=" block mt-5 not-italic font-bold py-5 text-center w-full lg:w-3/6 px-10 bg-slate-100 bg-opacity-20 hover:bg-opacity-40 text-slate-900 shadow hover:text-slate-900 hover:bg-white rounded-lg">
					<i class="fa-solid fa-glasses"></i>
					&nbsp;commencer la lecture</a>
			</div>
		</div>
	</section>
	{% if orderChap %}

		<section class="flex col-span-8 col-start-3 row-start-3 mt-6  pt-5 z-50">

			<div class="w-9/12">
				<h3 class="text-2xl mb-2">Chapitres</h3>
				<ul class="list-disc list-inside">
					{% for chapter in pubShow.publicationChapters|sort((a, b) => a.orderDisplay < b.orderDisplay ? -1 : 1) %}
						{% if chapter.status > 1 %}
							{% if chapter.slug %}
								{% set chapterSlug = chapter.slug %}
							{% else %}
								{% set chapterSlug = "feuille-n0" ~ (chapter.orderDisplay + 1) %}
							{% endif %}
							<li class=" list-none">
								<a href="{{ path("app_chapter_show", {idChap:chapter.id, slugPub:pubShow.slug, user:pubShow.user.username, slug:chapterSlug}) }}">
									{% if chapter.title  %}
										{{ chapter.title|capitalize }}
									{% else %}
										Feuille n°{{ chapter.orderDisplay + 1 }}
									{% endif %}
								</a>
							</li>
						{% endif %}
					{% endfor %}
				</div>
				<div class="w-3/12">f</div>
			</section>
		{% endif %}
	{% endblock %}
